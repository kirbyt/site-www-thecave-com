<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Kirby Turner">
    
    <meta name="description" content="Apple publishes daily sales figures on their iTunes Connect website for software vendors who have applications for sale in the iPhone App Store.  I’ve been making a point to download the daily file each morning but I know I cannot continue doing this manually.  What I need is an automated way to download the daily file.I searched the net for script code that will download the iTunes Connect daily sales report but I came up empty.  So I decided to write my own.I’ve been interested in getting into Python programming and I thought what better way to learn Python programming than to write a script that will download the daily sales report from the iTunes Connect website.  It turned out to be a fairly easy task to complete using Python.  Guess it goes to show how powerful Python really is.So here is my very first Python script.  I’m sure there are things I could do better in the script, but hey, it’s my first script.  Enjoy.UPDATE: The original code had a problem with retaining cookies set by the iTunes Connect website. The code below has been updated with the correct, working code.UPDATE 2: The Python script below is now hosted over at Google.  Just click here or visit http://code.google.com/p/appdailysales/ for the latest information and version.&lt;pre&gt;#!/usr/bin/python## appdailysales.py## iTune Connect Daily Sales Reports Downloader# Copyright 2008 Kirby Turner### This script will download yesterday’s daily sales report from# the iTunes Connect web site.  The downloaded file is stored# in the same directory containing the script file.  Note: if# the download file already exists then it will be overwritten.## The iTunes Connect web site has dynamic urls and form field# names.  In other words, these values change from session to# session.  So to get to the download file we must navigate  # the site and webscrape the pages.  Joy, joy.### Permission is hereby granted, free of charge, to any person obtaining a copy# of this software and associated documentation files (the “Software”), to deal# in the Software without restriction, including without limitation the rights# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell# copies of the Software, and to permit persons to whom the Software is# furnished to do so, subject to the following conditions:# # The above copyright notice and this permission notice shall be included in# all copies or substantial portions of the Software.# # THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN# THE SOFTWARE.# – Change the following to match your credentials –appleId = ‘Your Apple Id’password = ‘Your Password’# —————————————————-import urllibimport urllib2import cookielibimport datetimeimport reurlWebsite = ‘https://itunesconnect.apple.com/WebObjects/iTunesConnect.woa’urlActionLogin = ‘https://itunesconnect.apple.com%s’urlActionSalesReport = ‘https://itunesconnect.apple.com%s’print ‘– begin script –‘# There is an issue with Python 2.5 where it assumes the ‘version’# cookie value is always interger.  However, itunesconnect.apple.com# returns this value as a string, i.e., “1” instead of 1.  Because# of this we need a workaround that “fixes” the version field.## More information at: http://bugs.python.org/issue3924class MyCookieJar(cookielib.CookieJar): def _cookie_from_cookie_tuple(self, tup, request):  name, value, standard, rest = tup  version = standard.get(‘version’, None)  if version is not None:   version = version.replace(‘”’, ‘’)   standard[“version”] = version  return cookielib.CookieJar._cookie_from_cookie_tuple(self, tup, request)def showCookies(cj): for index, cookie in enumerate(cj):  print index, ‘ : ‘, cookie cj = MyCookieJar();opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))# Go to the iTunes Connect website and retrieve the# form action for logging into the site.urlHandle = opener.open(urlWebsite)html = urlHandle.read()match = re.search(‘action=”(.)”’, html)urlActionLogin = urlActionLogin % match.group(1)# Login to iTunes Connect web site and retrieve the# link to the sales report page.webFormLoginData = urllib.urlencode({‘theAccountName’:appleId, ‘theAccountPW’:password})urlHandle = opener.open(urlActionLogin, webFormLoginData)html = urlHandle.read()match = re.search(‘href=”(/WebObjects/iTunesConnect.woa/wo/.)”&gt;urlActionSalesReport = urlActionSalesReport % match.group(1)# Go to the sales report page, get the form action url and# form fields.  Note the sales report page will actually# load a blank page that redirects to the static URL. Best# guess here is that the server is setting some session# variables or something.urlHandle = opener.open(urlActionSalesReport)urlHandle = opener.open(‘https://itts.apple.com/cgi-bin/WebObjects/Piano.woa’)html = urlHandle.read()match = re.findall(‘action=”(.)”’, html)urlDownload = “https://itts.apple.com%s” % match[1]# Get the form field names needed to download the report.match = re.findall(‘name=”(.?)”’, html)fieldNameReportType = match[3]fieldNameReportPeriod = match[4]fieldNameDayOrWeekSelection = match[6]fieldNameSubmitTypeName = match[7]# Ah…more fun.  We need to post the page with the form# fields collected so far.  This will give us the remaining# form fields needed to get the download file.webFormSalesReportData = urllib.urlencode({fieldNameReportType:’Summary’, fieldNameReportPeriod:’Daily’, fieldNameDayOrWeekSelection:’Daily’, fieldNameSubmitTypeName:’ShowDropDown’})urlHandle = opener.open(urlDownload, webFormSalesReportData)html = urlHandle.read()match = re.findall(‘action=”(.)”’, html)urlDownload = “https://itts.apple.com%s” % match[1]match = re.findall(‘name=”(.?)”’, html)fieldNameDayOrWeekDropdown = match[5]# Set report date to yesterday’s date.  This will be the most# recent daily report available.  Another option would be to# webscrape the dropdown list of available report dates and# select the first item but setting the date to yesterday’s# date is easier.today = datetime.date.today() - datetime.timedelta(1)reportDate = ‘%i/%i/%i’ % (today.month, today.day, today.year)# And finally…we’re ready to download yesterday’s sales report.webFormSalesReportData = urllib.urlencode({fieldNameReportType:’Summary’, fieldNameReportPeriod:’Daily’, fieldNameDayOrWeekDropdown:reportDate, fieldNameDayOrWeekSelection:’Daily’, fieldNameSubmitTypeName:’Download’})urlHandle = opener.open(urlDownload, webFormSalesReportData)filename = urlHandle.info().getheader(‘content-disposition’).split(‘=’)[1]filebuffer = urlHandle.read()urlHandle.close()print ‘ saving download file:’, filenamed
ownloadFile = open(filename, ‘w’)downloadFile.write(filebuffer)downloadFile.close()print ‘– end of script –‘&lt;/pre&gt;
">
    

    <!-- Facebook tags -->
    <meta property="og:title" content="Download iTunes Connect Sales Reports Using Python" />
    
    <meta name="og:description" content="Apple publishes daily sales figures on their iTunes Connect website for software vendors who have applications for sale in the iPhone App Store.  I’ve been making a point to download the daily file each morning but I know I cannot continue doing this manually.  What I need is an automated way to download the daily file.I searched the net for script code that will download the iTunes Connect daily sales report but I came up empty.  So I decided to write my own.I’ve been interested in getting into Python programming and I thought what better way to learn Python programming than to write a script that will download the daily sales report from the iTunes Connect website.  It turned out to be a fairly easy task to complete using Python.  Guess it goes to show how powerful Python really is.So here is my very first Python script.  I’m sure there are things I could do better in the script, but hey, it’s my first script.  Enjoy.UPDATE: The original code had a problem with retaining cookies set by the iTunes Connect website. The code below has been updated with the correct, working code.UPDATE 2: The Python script below is now hosted over at Google.  Just click here or visit http://code.google.com/p/appdailysales/ for the latest information and version.&lt;pre&gt;#!/usr/bin/python## appdailysales.py## iTune Connect Daily Sales Reports Downloader# Copyright 2008 Kirby Turner### This script will download yesterday’s daily sales report from# the iTunes Connect web site.  The downloaded file is stored# in the same directory containing the script file.  Note: if# the download file already exists then it will be overwritten.## The iTunes Connect web site has dynamic urls and form field# names.  In other words, these values change from session to# session.  So to get to the download file we must navigate  # the site and webscrape the pages.  Joy, joy.### Permission is hereby granted, free of charge, to any person obtaining a copy# of this software and associated documentation files (the “Software”), to deal# in the Software without restriction, including without limitation the rights# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell# copies of the Software, and to permit persons to whom the Software is# furnished to do so, subject to the following conditions:# # The above copyright notice and this permission notice shall be included in# all copies or substantial portions of the Software.# # THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN# THE SOFTWARE.# – Change the following to match your credentials –appleId = ‘Your Apple Id’password = ‘Your Password’# —————————————————-import urllibimport urllib2import cookielibimport datetimeimport reurlWebsite = ‘https://itunesconnect.apple.com/WebObjects/iTunesConnect.woa’urlActionLogin = ‘https://itunesconnect.apple.com%s’urlActionSalesReport = ‘https://itunesconnect.apple.com%s’print ‘– begin script –‘# There is an issue with Python 2.5 where it assumes the ‘version’# cookie value is always interger.  However, itunesconnect.apple.com# returns this value as a string, i.e., “1” instead of 1.  Because# of this we need a workaround that “fixes” the version field.## More information at: http://bugs.python.org/issue3924class MyCookieJar(cookielib.CookieJar): def _cookie_from_cookie_tuple(self, tup, request):  name, value, standard, rest = tup  version = standard.get(‘version’, None)  if version is not None:   version = version.replace(‘”’, ‘’)   standard[“version”] = version  return cookielib.CookieJar._cookie_from_cookie_tuple(self, tup, request)def showCookies(cj): for index, cookie in enumerate(cj):  print index, ‘ : ‘, cookie cj = MyCookieJar();opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))# Go to the iTunes Connect website and retrieve the# form action for logging into the site.urlHandle = opener.open(urlWebsite)html = urlHandle.read()match = re.search(‘action=”(.)”’, html)urlActionLogin = urlActionLogin % match.group(1)# Login to iTunes Connect web site and retrieve the# link to the sales report page.webFormLoginData = urllib.urlencode({‘theAccountName’:appleId, ‘theAccountPW’:password})urlHandle = opener.open(urlActionLogin, webFormLoginData)html = urlHandle.read()match = re.search(‘href=”(/WebObjects/iTunesConnect.woa/wo/.)”&gt;urlActionSalesReport = urlActionSalesReport % match.group(1)# Go to the sales report page, get the form action url and# form fields.  Note the sales report page will actually# load a blank page that redirects to the static URL. Best# guess here is that the server is setting some session# variables or something.urlHandle = opener.open(urlActionSalesReport)urlHandle = opener.open(‘https://itts.apple.com/cgi-bin/WebObjects/Piano.woa’)html = urlHandle.read()match = re.findall(‘action=”(.)”’, html)urlDownload = “https://itts.apple.com%s” % match[1]# Get the form field names needed to download the report.match = re.findall(‘name=”(.?)”’, html)fieldNameReportType = match[3]fieldNameReportPeriod = match[4]fieldNameDayOrWeekSelection = match[6]fieldNameSubmitTypeName = match[7]# Ah…more fun.  We need to post the page with the form# fields collected so far.  This will give us the remaining# form fields needed to get the download file.webFormSalesReportData = urllib.urlencode({fieldNameReportType:’Summary’, fieldNameReportPeriod:’Daily’, fieldNameDayOrWeekSelection:’Daily’, fieldNameSubmitTypeName:’ShowDropDown’})urlHandle = opener.open(urlDownload, webFormSalesReportData)html = urlHandle.read()match = re.findall(‘action=”(.)”’, html)urlDownload = “https://itts.apple.com%s” % match[1]match = re.findall(‘name=”(.?)”’, html)fieldNameDayOrWeekDropdown = match[5]# Set report date to yesterday’s date.  This will be the most# recent daily report available.  Another option would be to# webscrape the dropdown list of available report dates and# select the first item but setting the date to yesterday’s# date is easier.today = datetime.date.today() - datetime.timedelta(1)reportDate = ‘%i/%i/%i’ % (today.month, today.day, today.year)# And finally…we’re ready to download yesterday’s sales report.webFormSalesReportData = urllib.urlencode({fieldNameReportType:’Summary’, fieldNameReportPeriod:’Daily’, fieldNameDayOrWeekDropdown:reportDate, fieldNameDayOrWeekSelection:’Daily’, fieldNameSubmitTypeName:’Download’})urlHandle = opener.open(urlDownload, webFormSalesReportData)filename = urlHandle.info().getheader(‘content-disposition’).split(‘=’)[1]filebuffer = urlHandle.read()urlHandle.close()print ‘ saving download file:’, filenamed
ownloadFile = open(filename, ‘w’)downloadFile.write(filebuffer)downloadFile.close()print ‘– end of script –‘&lt;/pre&gt;
">
    
    <meta property="og:type" content="article" />
    <meta property="article:author" content="https://www.facebook.com/mr.kirbyturner" />
    <meta property="og:image" content="http://www.thecave.com/img/bg-01.jpg" />
    <meta property="og:url" content="http://www.thecave.com/2008/10/21/download-itunes-connect-sales-reports-using-python/" />
    <meta property="og:site_name" content="thecave | A Hideout for Programmers, Indie Devs, Solopreneurs" />

    <title>Download iTunes Connect Sales Reports Using Python</title>

    <link href="https://micro.blog/kirbyt" rel="me" />
    <link rel="canonical" href="http://www.thecave.com/2008/10/21/download-itunes-connect-sales-reports-using-python/">
    <link rel="alternate" type="application/atom+xml" title="thecave | A Hideout for Programmers, Indie Devs, Solopreneurs's Feed" href="http://www.thecave.com/feed.xml" />


    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.min.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- YouTube CSS -->
    <link rel="stylesheet" href="/css/video.css">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">thecave</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
                <li>
                    <a href="/about/">About</a>
                </li>
                
                <li>
                    <a href="/archive/">Archive</a>
                </li>
                
                <li>
                    <a href="/categories/">Categories & Tags</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/bg-01.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Download iTunes Connect Sales Reports Using Python</h1>
                    
                    <span class="meta">Posted by Kirby Turner on October 21, 2008</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p>Apple publishes daily sales figures on their iTunes Connect website for software vendors who have applications for sale in the iPhone App Store.  I’ve been making a point to download the daily file each morning but I know I cannot continue doing this manually.  What I need is an automated way to download the daily file.<br /><br />I searched the net for script code that will download the iTunes Connect daily sales report but I came up empty.  So I decided to write my own.<br /><br />I’ve been interested in getting into Python programming and I thought what better way to learn Python programming than to write a script that will download the daily sales report from the iTunes Connect website.  It turned out to be a fairly easy task to complete using Python.  Guess it goes to show how powerful Python really is.<br /><br />So here is my very first Python script.  I’m sure there are things I could do better in the script, but hey, it’s my first script.  Enjoy.<br /><br /><span style="color:red">UPDATE:</span> The original code had a problem with retaining cookies set by the iTunes Connect website. The code below has been updated with the correct, working code.<br /><br /><span style="color:red">UPDATE 2:</span> The Python script below is now hosted over at Google.  Just click <a href="http://code.google.com/p/appdailysales/source/browse/trunk/appdailysales.py">here</a> or visit <a href="http://code.google.com/p/appdailysales/">http://code.google.com/p/appdailysales/</a> for the latest information and version.<br /><br />&lt;pre&gt;<br />#!/usr/bin/python<br />#<br /># appdailysales.py<br />#<br /># iTune Connect Daily Sales Reports Downloader<br /># Copyright 2008 Kirby Turner<br />#<br />#<br /># This script will download yesterday’s daily sales report from<br /># the iTunes Connect web site.  The downloaded file is stored<br /># in the same directory containing the script file.  Note: if<br /># the download file already exists then it will be overwritten.<br />#<br /># The iTunes Connect web site has dynamic urls and form field<br /># names.  In other words, these values change from session to<br /># session.  So to get to the download file we must navigate  <br /># the site and webscrape the pages.  Joy, joy.<br />#<br />#<br /># Permission is hereby granted, free of charge, to any person obtaining a copy<br /># of this software and associated documentation files (the “Software”), to deal<br /># in the Software without restriction, including without limitation the rights<br /># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell<br /># copies of the Software, and to permit persons to whom the Software is<br /># furnished to do so, subject to the following conditions:<br /># <br /># The above copyright notice and this permission notice shall be included in<br /># all copies or substantial portions of the Software.<br /># <br /># THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR<br /># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,<br /># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE<br /># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER<br /># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,<br /># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN<br /># THE SOFTWARE.<br /><br /><br /># – Change the following to match your credentials –<br />appleId = ‘Your Apple Id’<br />password = ‘Your Password’<br /># —————————————————-<br /><br /><br />import urllib<br />import urllib2<br />import cookielib<br />import datetime<br />import re<br /><br />urlWebsite = ‘https://itunesconnect.apple.com/WebObjects/iTunesConnect.woa’<br />urlActionLogin = ‘https://itunesconnect.apple.com%s’<br />urlActionSalesReport = ‘https://itunesconnect.apple.com%s’<br /><br />print ‘– begin script –‘<br /><br /># There is an issue with Python 2.5 where it assumes the ‘version’<br /># cookie value is always interger.  However, itunesconnect.apple.com<br /># returns this value as a string, i.e., “1” instead of 1.  Because<br /># of this we need a workaround that “fixes” the version field.<br />#<br /># More information at: http://bugs.python.org/issue3924<br />class MyCookieJar(cookielib.CookieJar):<br /> def _cookie_from_cookie_tuple(self, tup, request):<br />  name, value, standard, rest = tup<br />  version = standard.get(‘version’, None)<br />  if version is not None:<br />   version = version.replace(‘”’, ‘’)<br />   standard[“version”] = version<br />  return cookielib.CookieJar._cookie_from_cookie_tuple(self, tup, request)<br /><br /><br />def showCookies(cj):<br /> for index, cookie in enumerate(cj):<br />  print index, ‘ : ‘, cookie<br /> <br /><br />cj = MyCookieJar();<br />opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))<br /><br /><br /><br /># Go to the iTunes Connect website and retrieve the<br /># form action for logging into the site.<br />urlHandle = opener.open(urlWebsite)<br />html = urlHandle.read()<br />match = re.search(‘action=”(.<em>)”’, html)<br />urlActionLogin = urlActionLogin % match.group(1)<br /><br /><br /># Login to iTunes Connect web site and retrieve the<br /># link to the sales report page.<br />webFormLoginData = urllib.urlencode({‘theAccountName’:appleId, ‘theAccountPW’:password})<br />urlHandle = opener.open(urlActionLogin, webFormLoginData)<br />html = urlHandle.read()<br />match = re.search(‘href=”(/WebObjects/iTunesConnect.woa/wo/.</em>)”&gt;<img /><br />urlActionSalesReport = urlActionSalesReport % match.group(1)<br /><br /><br /># Go to the sales report page, get the form action url and<br /># form fields.  Note the sales report page will actually<br /># load a blank page that redirects to the static URL. Best<br /># guess here is that the server is setting some session<br /># variables or something.<br />urlHandle = opener.open(urlActionSalesReport)<br />urlHandle = opener.open(‘https://itts.apple.com/cgi-bin/WebObjects/Piano.woa’)<br />html = urlHandle.read()<br />match = re.findall(‘action=”(.<em>)”’, html)<br />urlDownload = “https://itts.apple.com%s” % match[1]<br /><br /><br /># Get the form field names needed to download the report.<br />match = re.findall(‘name=”(.</em>?)”’, html)<br />fieldNameReportType = match[3]<br />fieldNameReportPeriod = match[4]<br />fieldNameDayOrWeekSelection = match[6]<br />fieldNameSubmitTypeName = match[7]<br /><br /><br /># Ah…more fun.  We need to post the page with the form<br /># fields collected so far.  This will give us the remaining<br /># form fields needed to get the download file.<br />webFormSalesReportData = urllib.urlencode({fieldNameReportType:’Summary’, fieldNameReportPeriod:’Daily’, fieldNameDayOrWeekSelection:’Daily’, fieldNameSubmitTypeName:’ShowDropDown’})<br />urlHandle = opener.open(urlDownload, webFormSalesReportData)<br />html = urlHandle.read()<br />match = re.findall(‘action=”(.<em>)”’, html)<br />urlDownload = “https://itts.apple.com%s” % match[1]<br />match = re.findall(‘name=”(.</em>?)”’, html)<br />fieldNameDayOrWeekDropdown = match[5]<br /><br /><br /># Set report date to yesterday’s date.  This will be the most<br /># recent daily report available.  Another option would be to<br /># webscrape the dropdown list of available report dates and<br /># select the first item but setting the date to yesterday’s<br /># date is easier.<br />today = datetime.date.today() - datetime.timedelta(1)<br />reportDate = ‘%i/%i/%i’ % (today.month, today.day, today.year)<br /><br /><br /># And finally…we’re ready to download yesterday’s sales report.<br />webFormSalesReportData = urllib.urlencode({fieldNameReportType:’Summary’, fieldNameReportPeriod:’Daily’, fieldNameDayOrWeekDropdown:reportDate, fieldNameDayOrWeekSelection:’Daily’, fieldNameSubmitTypeName:’Download’})<br />urlHandle = opener.open(urlDownload, webFormSalesReportData)<br />filename = urlHandle.info().getheader(‘content-disposition’).split(‘=’)[1]<br />filebuffer = urlHandle.read()<br />urlHandle.close()<br /><br /><br />print ‘ saving download file:’, filename<br />d
ownloadFile = open(filename, ‘w’)<br />downloadFile.write(filebuffer)<br />downloadFile.close()<br /><br />print ‘– end of script –‘<br />&lt;/pre&gt;</p>


                <hr>

                
                    <p>
                    Posted in <a class='category' href='/category/uncategorized/'>uncategorized</a>. 
                    Tagged in .
                    </p>
                

                

                

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2008/10/10/pictures-from-recent-memphis-trip/" data-toggle="tooltip" data-placement="top" title="Pictures from Recent Memphis Trip">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2008/10/23/hug-a-developer/" data-toggle="tooltip" data-placement="top" title="Hug a Developer">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<p>&nbsp;</p>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-md-5 col-md-offset-1 col-xs-12">
                <h3>Recent Articles</h3>
                <ul>
                
                <li><a href="/2017/06/18/swimming-hole/" title="">June 18, 2017 at 06:20:22 PM</a></li>
                
                <li><a href="/2017/06/15/crazy-hair-day/" title="">June 15, 2017 at 08:24:35 AM</a></li>
                
                <li><a href="/2017/06/11/fire-fire-fire/" title="">June 11, 2017 at 09:14:14 PM</a></li>
                
                <li><a href="/2017/05/19/long-day/" title="">May 19, 2017 at 09:22:28 PM</a></li>
                
                <li><a href="/2017/05/12/dropshare-app/" title="">May 12, 2017 at 09:56:52 PM</a></li>
                
                </ul>                
            </div>
            <div class="col-md-5 col-md-offset-1 col-xs-12">
                <h3>Other Sites</h3>
                <ul>
<!--                     
                    <li><a href="http://photos.thecave.com/">And More Photos</a></li>
                    <li><a href="http://www.rowanturner.net/">Rowan Turner</a></li>
 -->                    
                    <li><a href="http://www.kirbyturner.com/">Kirby Turner</a></li>
                    <li><a href="https://www.flickr.com/photos/kirbyturner/">Photos</a></li>
                    <li><a href="http://www.whitepeaksoftware.com/">White Peak Software</a></li>
<!--                     
                    <li><a href="http://www.peakappcare.com/">Peak App Care</a></li>
 -->                
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <br />
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://alpha.app.net/kirbyt">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-adn fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://twitter.com/kirbyt">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/kirbyt">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="http://www.linkedin.com/in/kirbyt/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Kirby Turner 2017</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>

<!-- Google -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-167605-3', 'auto');
  ga('send', 'pageview');

</script>

<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '5902978';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/5902978.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>


</body>

</html>
